<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ± - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ</title>
    <style>
        :root { --gold: #ffd700; --energy: #00bcd4; }
        body { background: #1b5e20; font-family: 'Segoe UI', sans-serif; margin: 0; color: white; text-align: center; }
        
        .header { background: #2e7d32; padding: 10px; display: flex; justify-content: space-around; border-bottom: 4px solid var(--gold); position: sticky; top: 0; z-index: 100; }
        .stat { background: rgba(0,0,0,0.4); padding: 5px 12px; border-radius: 15px; border: 1px solid var(--gold); font-weight: bold; font-size: 18px; }
        
        .energy-bar-container { width: 250px; height: 18px; background: #eee; border-radius: 10px; margin: 15px auto; border: 2px solid #fff; overflow: hidden; }
        #energy-fill { width: 100%; height: 100%; background: var(--energy); transition: 0.5s; }

        .farm-world { display: grid; grid-template-columns: repeat(4, 75px); gap: 10px; justify-content: center; padding: 20px; background: #4caf50; border: 8px solid #3e2723; border-radius: 20px; margin: 10px auto; width: fit-content; box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
        .plot { width: 75px; height: 75px; background: #5d4037; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 35px; cursor: pointer; border: 2px solid #3d1c02; }

        .btn { background: #e67e22; color: white; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; margin: 10px; font-size: 16px; box-shadow: 0 4px #d35400; }
        .btn:active { box-shadow: none; transform: translateY(4px); }
        
        #login-screen { background: radial-gradient(#2e7d32, #1b5e20); position: fixed; inset: 0; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1 style="color:var(--gold); text-shadow: 2px 2px #000;">ğŸšœ Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ± V5 ğŸŒ¾</h1>
        <p>Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù…Ø²Ø±Ø¹ØªÙƒ:</p>
        <input type="text" id="username" placeholder="Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§..." style="padding:15px; border-radius:10px; border:none; width:250px; text-align:center; font-size:18px;">
        <br>
        <button onclick="login()" style="padding:15px 60px; background:var(--gold); color:#333; border:none; border-radius:10px; font-weight:bold; cursor:pointer; font-size:20px;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</button>
    </div>

    <div id="game" class="hidden">
        <div class="header">
            <div class="stat">ğŸ’° <span id="gold">0</span></div>
            <div class="stat">â­ Ù…Ø³ØªÙˆÙ‰: <span id="lvl-display">1</span></div>
            <div class="stat">ğŸ“¦ <span id="inv">0</span></div>
        </div>

        <div class="energy-bar-container"><div id="energy-fill"></div></div>
        <p>âš¡ Ø§Ù„Ø·Ø§Ù‚Ø©: <span id="energy-text">100</span>%</p>

        <div class="farm-world" id="grid"></div>

        <div style="background:rgba(255,255,255,0.1); padding:10px; margin:10px; border-radius:15px;">
            <button class="btn" onclick="sellEverything()" style="background:#2ecc71">Ø¨ÙŠØ¹ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ ğŸ’°</button>
            <button class="btn" onclick="buyEnergy()" style="background:#3498db">Ø´Ø­Ù† Ø·Ø§Ù‚Ø© (50 Ø°Ù‡Ø¨)</button>
        </div>
    </div>

    <script>
        let data = { user: "", gold: 1000, inv: 0, energy: 100, lvl: 1 };

        function login() {
            let u = document.getElementById('username').value.trim();
            if(!u) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ");
            
            let saved = localStorage.getItem('pro_farm_' + u) || localStorage.getItem('happy_farm_' + u);
            if(saved) data = JSON.parse(saved);
            else data.user = u;
            
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('game').classList.remove('hidden');
            initGrid();
            update();
            setInterval(regenEnergy, 5000);
        }

        function initGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            for(let i=0; i<16; i++) {
                let p = document.createElement('div');
                p.className = 'plot';
                p.onclick = () => work(p);
                grid.appendChild(p);
            }
        }

        function work(p) {
            if(p.innerHTML === "" && data.energy >= 10) {
                data.energy -= 10;
                p.innerHTML = "ğŸŒ±";
                update();
                setTimeout(() => {
                    // Ø´ÙƒÙ„ Ø§Ù„Ø²Ø±Ø¹ ÙŠØªØºÙŠØ± Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                    if (data.lvl >= 4) p.innerHTML = "ğŸ“";
                    else if (data.lvl >= 2) p.innerHTML = "ğŸ…";
                    else p.innerHTML = "ğŸŒ¾";
                    
                    p.onclick = () => {
                        data.inv++;
                        p.innerHTML = "";
                        p.onclick = () => work(p);
                        update();
                    };
                }, 3000);
            } else if(data.energy < 10) { alert("Ø·Ø§Ù‚ØªÙƒ Ù†ÙØ°Øª! Ø§Ø´Ø­Ù† Ø·Ø§Ù‚ØªÙƒ Ù„ØªÙƒÙ…Ù„ Ø§Ù„Ø¹Ù…Ù„."); }
        }

        function checkLevel() {
            let oldLvl = data.lvl;
            if (data.gold >= 10000) data.lvl = 4;
            else if (data.gold >= 5000) data.lvl = 3;
            else if (data.gold >= 2000) data.lvl = 2;
            
            if (data.lvl > oldLvl) {
                alert("ğŸŠ Ù…Ø¨Ø±ÙˆÙƒ ÙŠØ§ Ø¨Ø·Ù„! Ø§Ø±ØªÙØ¹ Ù…Ø³ØªÙˆØ§Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ " + data.lvl);
            }
        }

        function sellEverything() {
            if(data.inv > 0) {
                let price = 100 + (data.lvl * 50); // Ø§Ù„Ø³Ø¹Ø± ÙŠØ²ÙŠØ¯ Ø¨Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                data.gold += data.inv * price;
                data.inv = 0;
                checkLevel();
                update();
            }
        }

        function buyEnergy() {
            if(data.gold >= 50) {
                data.gold -= 50;
                data.energy = Math.min(data.energy + 40, 100);
                update();
            }
        }

        function regenEnergy() {
            if(data.energy < 100) {
                data.energy += 2;
                update();
            }
        }

        function update() {
            document.getElementById('gold').innerText = data.gold;
            document.getElementById('lvl-display').innerText = data.lvl; // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù‚Ù… ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©
            document.getElementById('energy-text').innerText = data.energy;
            document.getElementById('energy-fill').style.width = data.energy + "%";
            document.getElementById('inv').innerText = data.inv;
            localStorage.setItem('pro_farm_' + data.user, JSON.stringify(data));
        }
    </script>
</body>
</html>
