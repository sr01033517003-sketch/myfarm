<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©</title>
    <style>
        body { background: #2e7d32; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; color: white; overflow-x: hidden; }
        .top-bar { background: #1b5e20; padding: 15px; display: flex; justify-content: space-around; border-bottom: 4px solid #ffd700; position: sticky; top: 0; z-index: 1000; }
        .stat-box { background: rgba(0,0,0,0.4); padding: 8px 20px; border-radius: 20px; border: 1px solid #ffd700; font-weight: bold; font-size: 18px; }
        
        .game-world { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª */
        .zone { background: #81c784; border: 6px solid #5d4037; border-radius: 25px; padding: 15px; min-width: 300px; min-height: 250px; position: relative; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        .zone-title { background: #5d4037; color: white; padding: 5px 15px; border-radius: 10px; position: absolute; top: -15px; right: 20px; font-weight: bold; }
        
        .animal { position: absolute; font-size: 40px; transition: all 3s ease-in-out; cursor: pointer; filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.2)); }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ø±Ø§Ø¹Ø© */
        .farm-grid { display: grid; grid-template-columns: repeat(4, 70px); gap: 10px; background: #4caf50; border: 8px solid #3e2723; border-radius: 20px; padding: 15px; }
        .plot { width: 70px; height: 70px; background: #5d4037; border-radius: 8px; border: 2px solid #3d1c02; display: flex; align-items: center; justify-content: center; font-size: 30px; cursor: pointer; position: relative; }
        .timer { position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.6); color: #00ff00; font-size: 10px; text-align: center; border-radius: 0 0 5px 5px; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¢Ù„Ø§Øª */
        .machine-slot { width: 80px; height: 80px; background: #cfd8dc; border: 3px dashed #37474f; border-radius: 10px; display: inline-flex; align-items: center; justify-content: center; font-size: 40px; margin: 5px; }

        .shop-panel { background: white; color: #333; width: 100%; max-width: 900px; margin: 20px auto; border-radius: 20px; padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 15px; }
        .shop-item { border: 2px solid #eee; padding: 10px; border-radius: 15px; text-align: center; }
        .btn-buy { background: #e67e22; color: white; border: none; padding: 8px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 5px; }
        .btn-sell { background: #2ecc71; color: white; border: none; padding: 15px 40px; border-radius: 50px; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 5px #27ae60; margin-bottom: 20px; }
        .btn-sell:active { transform: translateY(3px); box-shadow: none; }

        #login-screen { position: fixed; inset: 0; background: #2e7d32; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div style="background:white; color:black; padding:40px; border-radius:30px; text-align:center; box-shadow: 0 0 30px rgba(0,0,0,0.5);">
            <h1 style="color:#2e7d32; margin-bottom:10px;">ğŸšœ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø³Ø¹ÙŠØ¯Ø© V10</h1>
            <p>Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„ÙØªØ­ Ø¨ÙˆØ§Ø¨Ø§Øª Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</p>
            <input type="text" id="username" placeholder="Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§..." style="padding:15px; width:250px; border-radius:10px; border:2px solid #2e7d32; font-size:18px;"><br><br>
            <button onclick="login()" style="padding:15px 60px; background:#ffd700; color:#333; border:none; border-radius:15px; font-weight:bold; font-size:20px; cursor:pointer;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <div id="game-ui" class="hidden">
        <div class="top-bar">
            <div class="stat-box">ğŸ’° Ø°Ù‡Ø¨: <span id="gold-val">0</span></div>
            <div class="stat-box">â­ Ù…Ø³ØªÙˆÙ‰: <span id="lvl-val">1</span></div>
            <div class="stat-box">ğŸ¯ Ø¹Ø³Ù„: <span id="honey-val">0</span></div>
        </div>

        <div class="game-world">
            <div class="zone" id="animal-zone">
                <div class="zone-title">ğŸ„ Ø³Ø§Ø­Ø© Ø§Ù„Ù…ÙˆØ§Ø´ÙŠ ÙˆØ§Ù„Ø·ÙŠÙˆØ±</div>
            </div>

            <div class="zone" style="background:#5d4037; min-width:auto;">
                <div class="zone-title">ğŸŒ± Ø§Ù„Ø£Ø±Ø¶ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</div>
                <div class="farm-grid" id="grid"></div>
            </div>

            <div class="zone" id="machine-zone" style="background:#90a4ae;">
                <div class="zone-title">ğŸ­ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¢Ù„Ø§Øª ÙˆØ§Ù„Ù…ØµØ§Ù†Ø¹</div>
                <div id="machine-list"></div>
            </div>
        </div>

        <center>
            <button class="btn-sell" onclick="sellEverything()">ğŸ’° Ø¨ÙŠØ¹ ÙƒÙ„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ ğŸ’°</button>
        </center>

        <div class="shop-panel">
            <div class="shop-item">ğŸ¥ Ø¯Ø¬Ø§Ø¬Ø©<br>100 ğŸ’°<button class="btn-buy" onclick="buy('ğŸ¥', 100, 'animal')">Ø´Ø±Ø§Ø¡</button></div>
            <div class="shop-item">ğŸ„ Ø¨Ù‚Ø±Ø©<br>500 ğŸ’°<button class="btn-buy" onclick="buy('ğŸ„', 500, 'animal')">Ø´Ø±Ø§Ø¡</button></div>
            <div class="shop-item">ğŸ Ø®Ù„ÙŠØ© Ù†Ø­Ù„<br>1200 ğŸ’°<button class="btn-buy" onclick="buy('ğŸ', 1200, 'machine')">Ø´Ø±Ø§Ø¡</button></div>
            <div class="shop-item">ğŸšœ Ø¬Ø±Ø§Ø±<br>2000 ğŸ’°<button class="btn-buy" onclick="buy('ğŸšœ', 2000, 'machine')">Ø´Ø±Ø§Ø¡</button></div>
            <div class="shop-item">ğŸ­ Ù…ØµÙ†Ø¹<br>4000 ğŸ’°<button class="btn-buy" onclick="buy('ğŸ­', 4000, 'machine')">Ø´Ø±Ø§Ø¡</button></div>
        </div>
    </div>

    <script>
        let farm = { user: "", gold: 2000, lvl: 1, inv: 0, honey: 0, ownedAnimals: [], ownedMachines: [] };
        const GROWTH_TIME = 180; // 3 Ø¯Ù‚Ø§Ø¦Ù‚

        function login() {
            let u = document.getElementById('username').value.trim();
            if(!u) return;
            let saved = localStorage.getItem('master_farm_v10_' + u);
            if(saved) farm = JSON.parse(saved);
            else farm.user = u;
            
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('game-ui').classList.remove('hidden');
            
            initGrid();
            farm.ownedAnimals.forEach(a => renderAnimal(a));
            farm.ownedMachines.forEach(m => renderMachine(m));
            updateUI();
            
            setInterval(moveAnimals, 4000);
            setInterval(() => {
                let hives = farm.ownedMachines.filter(m => m === 'ğŸ').length;
                if(hives > 0) { farm.honey += hives; updateUI(); }
            }, 10000);
        }

        function initGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            for(let i=0; i<16; i++) {
                let p = document.createElement('div');
                p.className = 'plot';
                p.onclick = () => plant(p);
                grid.appendChild(p);
            }
        }

        function plant(p) {
            if(p.innerText === "") {
                p.innerText = "ğŸŒ±";
                let timeLeft = GROWTH_TIME;
                let timer = document.createElement('div');
                timer.className = 'timer';
                p.appendChild(timer);

                let countdown = setInterval(() => {
                    timeLeft--;
                    let mins = Math.floor(timeLeft / 60);
                    let secs = timeLeft % 60;
                    timer.innerText = `${mins}:${secs < 10 ? '0'+secs : secs}`;

                    if(timeLeft <= 0) {
                        clearInterval(countdown);
                        let crops = ["ğŸŒ¿", "ğŸŒ¾", "ğŸ…", "ğŸŒ½", "ğŸ“"];
                        p.innerText = crops[Math.floor(Math.random() * crops.length)];
                        p.onclick = () => {
                            farm.inv++;
                            p.innerText = "";
                            p.onclick = () => plant(p);
                            updateUI();
                        };
                    }
                }, 1000);
            }
        }

        function buy(item, price, type) {
            if(farm.gold >= price) {
                farm.gold -= price;
                if(type === 'animal') {
                    farm.ownedAnimals.push(item);
                    renderAnimal(item);
                } else {
                    farm.ownedMachines.push(item);
                    renderMachine(item);
                }
                updateUI();
            } else { alert("Ø§Ù„Ø°Ù‡Ø¨ Ù„Ø§ ÙŠÙƒÙÙŠ!"); }
        }

        function renderAnimal(emoji) {
            let a = document.createElement('div');
            a.className = 'animal';
            a.innerText = emoji;
            a.style.left = "50%"; a.style.top = "50%";
            document.getElementById('animal-zone').appendChild(a);
        }

        function renderMachine(emoji) {
            let m = document.createElement('div');
            m.className = 'machine-slot';
            m.innerText = emoji;
            document.getElementById('machine-list').appendChild(m);
        }

        function moveAnimals() {
            let animals = document.getElementsByClassName('animal');
            for(let a of animals) {
                a.style.left = Math.random() * 80 + 5 + "%";
                a.style.top = Math.random() * 80 + 5 + "%";
            }
        }

        function sellEverything() {
            let total = (farm.inv * 200) + (farm.honey * 500);
            if(total > 0) {
                farm.gold += total;
                farm.inv = 0; farm.honey = 0;
                farm.lvl = Math.floor(farm.gold / 5000) + 1;
                updateUI();
                alert("ØªÙ… Ø¨ÙŠØ¹ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø¨Ù†Ø¬Ø§Ø­!");
            }
        }

        function updateUI() {
            document.getElementById('gold-val').innerText = farm.gold;
            document.getElementById('lvl-val').innerText = farm.lvl;
            document.getElementById('honey-val').innerText = farm.honey;
            localStorage.setItem('master_farm_v10_' + farm.user, JSON.stringify(farm));
        }
    </script>
</body>
        </html>
