<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
    <style>
        :root { --gold: #ffd700; --green: #2e7d32; --dirt: #5d4037; }
        body { background: #1b5e20; font-family: 'Segoe UI', sans-serif; margin: 0; color: white; overflow-x: hidden; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen { background: rgba(0,0,0,0.95); position: fixed; inset: 0; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .login-box { background: #fff; padding: 30px; border-radius: 20px; color: #333; text-align: center; border: 5px solid var(--gold); }
        input { padding: 12px; margin: 10px; border-radius: 8px; border: 2px solid #ddd; width: 200px; font-size: 16px; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
        .header { background: #2e7d32; padding: 10px; display: flex; justify-content: space-around; border-bottom: 4px solid var(--gold); position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .stat-card { background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 18px; border: 1px solid var(--gold); }

        /* Ø£Ø±Ø¶ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© ÙˆØ§Ù„Ø´Ø¨ÙƒØ© */
        .world-map { padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .farm-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; background: #4caf50; padding: 15px; border: 8px solid #3e2723; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .plot { width: 80px; height: 80px; background: var(--dirt); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 40px; cursor: pointer; border: 2px solid #3d1c02; transition: 0.2s; }
        .plot:hover { transform: scale(1.05); background: #6d4c41; }

        /* Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„Ù…Ø®Ø²Ù† */
        .tabs { display: flex; width: 100%; background: #388e3c; }
        .tab-btn { flex: 1; padding: 15px; border: none; color: white; font-weight: bold; cursor: pointer; font-size: 16px; }
        .tab-btn.active { background: #1b5e20; border-bottom: 4px solid var(--gold); }
        .content-area { background: #f1f8e9; color: #333; padding: 15px; min-height: 200px; display: none; }
        .content-area.active { display: block; }

        .shop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; }
        .item { background: white; border: 2px solid #ddd; border-radius: 12px; padding: 10px; text-align: center; }
        .item button { background: #e67e22; border: none; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 5px; }

        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .chat-box { background: rgba(0,0,0,0.8); height: 100px; width: 90%; margin: 10px auto; border-radius: 10px; padding: 10px; font-size: 14px; overflow-y: auto; text-align: right; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h1 style="margin-top:0">ğŸšœ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø³Ø¹ÙŠØ¯Ø© V4 ğŸŒ¾</h1>
            <p>Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø­ÙØ¸ Ù…Ø²Ø±Ø¹ØªÙƒ Ù„Ù„Ø£Ø¨Ø¯</p>
            <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            <br>
            <button onclick="login()" style="background: #2e7d32; color: white; padding: 12px 50px; border: none; border-radius: 10px; font-size: 18px; cursor: pointer; font-weight: bold;">Ø§Ù†Ø·Ù„Ù‚ Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <div id="main-game" style="display:none">
        <div class="header">
            <div class="stat-card">ğŸ’° <span id="gold-val">1000</span></div>
            <div class="stat-card">â­ Ù…Ø³ØªÙˆÙ‰: <span id="lvl-val">1</span></div>
            <div class="stat-card">ğŸ“¦ <span id="inv-val">0</span></div>
            <button onclick="logout()" style="background:red; color:white; border:none; border-radius:5px; padding:5px 10px;">Ø®Ø±ÙˆØ¬</button>
        </div>

        <div class="world-map">
            <h3>ğŸ¡ Ù…Ø²Ø±Ø¹Ø© <span id="user-display"></span></h3>
            <div class="farm-grid" id="grid">
                <script>
                    for(let i=0; i<16; i++) document.write('<div class="plot" onclick="workPlot(this)"></div>');
                </script>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('shop-tab', this)">ğŸ›’ Ø§Ù„Ù…ØªØ¬Ø±</button>
            <button class="tab-btn" onclick="openTab('inv-tab', this)">ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù†</button>
            <button class="tab-btn" onclick="openTab('chat-tab', this)">ğŸ’¬ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</button>
        </div>

        <div id="shop-tab" class="content-area active">
            <div class="shop-grid">
                <div class="item">ğŸ¥ Ø¯Ø¬Ø§Ø¬Ø©<br>50 ğŸ’°<button onclick="buyItem('ğŸ¥', 50, 'Ø­ÙŠÙˆØ§Ù†')">Ø´Ø±Ø§Ø¡</button></div>
                <div class="item">ğŸ„ Ø¨Ù‚Ø±Ø©<br>200 ğŸ’°<button onclick="buyItem('ğŸ„', 200, 'Ø­ÙŠÙˆØ§Ù†')">Ø´Ø±Ø§Ø¡</button></div>
                <div class="item">ğŸ• ÙƒÙ„Ø¨ Ø­Ø±Ø§Ø³Ø©<br>500 ğŸ’°<button onclick="buyItem('ğŸ•', 500, 'Ø­ÙŠÙˆØ§Ù†')">Ø´Ø±Ø§Ø¡</button></div>
                <div class="item">ğŸ Ø´Ø¬Ø± ØªÙØ§Ø­<br>300 ğŸ’°<button onclick="buyItem('ğŸ', 300, 'Ø´Ø¬Ø±')">Ø´Ø±Ø§Ø¡</button></div>
                <div class="item">ğŸŒ Ø´Ø¬Ø± Ù…ÙˆØ²<br>350 ğŸ’°<button onclick="buyItem('ğŸŒ', 350, 'Ø´Ø¬Ø±')">Ø´Ø±Ø§Ø¡</button></div>
                <div class="item">ğŸšœ Ø¬Ø±Ø§Ø±<br>1500 ğŸ’°<button onclick="buyItem('ğŸšœ', 1500, 'Ø¢Ù„Ø©')">Ø´Ø±Ø§Ø¡</button></div>
                <div class="item">ğŸ­ Ù…ØµÙ†Ø¹ Ø¬Ø¨Ù†<br>2000 ğŸ’°<button onclick="buyItem('ğŸ­', 2000, 'Ø¢Ù„Ø©')">Ø´Ø±Ø§Ø¡</button></div>
            </div>
        </div>

        <div id="inv-tab" class="content-area">
            <h4>Ù…Ø­Ø§ØµÙŠÙ„Ùƒ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©:</h4>
            <div id="inv-list">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø§ØµÙŠÙ„</div>
            <button onclick="sellAll()" style="background:#2e7d32; color:white; padding:10px; width:100%; border:none; margin-top:10px; border-radius:5px; font-weight:bold;">Ø¨ÙŠØ¹ Ø§Ù„ÙƒÙ„ ÙˆÙƒØ³Ø¨ Ø§Ù„Ø°Ù‡Ø¨ ğŸ’°</button>
        </div>

        <div id="chat-tab" class="content-area">
            <div class="chat-box" id="chat">
                <p>ğŸ’¡ Ù†Ø¸Ø§Ù…: Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡!</p>
            </div>
            <input type="text" style="width:70%" id="chat-msg" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
            <button onclick="sendMsg()" style="padding:10px; background:#1b5e20; color:white; border:none; border-radius:5px;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <script>
        let farmData = { user: "", gold: 1000, lvl: 1, inventory: 0, items: [] };

        function login() {
            let u = document.getElementById('username').value;
            if(!u) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ");
            
            let saved = localStorage.getItem('happy_farm_' + u);
            if(saved) {
                farmData = JSON.parse(saved);
            } else {
                farmData.user = u;
            }
            
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-game').style.display = 'block';
            updateUI();
        }

        function updateUI() {
            document.getElementById('gold-val').innerText = farmData.gold;
            document.getElementById('lvl-val').innerText = farmData.lvl;
            document.getElementById('inv-val').innerText = farmData.inventory;
            document.getElementById('user-display').innerText = farmData.user;
            document.getElementById('inv-list').innerText = "Ù„Ø¯ÙŠÙƒ " + farmData.inventory + " Ù…Ø­ØµÙˆÙ„ Ù…ØªÙ†ÙˆØ¹.";
            localStorage.setItem('happy_farm_' + farmData.user, JSON.stringify(farmData));
        }

        function workPlot(plot) {
            if(plot.innerHTML === "") {
                plot.innerHTML = "ğŸŒ±";
                setTimeout(() => {
                    plot.innerHTML = "ğŸŒ½";
                    plot.onclick = () => {
                        farmData.inventory++;
                        plot.innerHTML = "";
                        plot.onclick = () => workPlot(plot);
                        updateUI();
                    };
                }, 2000);
            }
        }

        function buyItem(item, price, type) {
            if(farmData.gold >= price) {
                farmData.gold -= price;
                farmData.items.push(item);
                updateUI();
                alert("ØªÙ… Ø´Ø±Ø§Ø¡ " + item + " ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù„Ù…Ø²Ø±Ø¹ØªÙƒ!");
            } else {
                alert("Ø§Ù„Ø°Ù‡Ø¨ Ù„Ø§ ÙŠÙƒÙÙŠ!");
            }
        }

        function sellAll() {
            if(farmData.inventory > 0) {
                farmData.gold += farmData.inventory * 120;
                farmData.inventory = 0;
                updateUI();
                alert("ØªÙ… Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
            }
        }

        function openTab(id, btn) {
            document.querySelectorAll('.content-area').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        function sendMsg() {
            let m = document.getElementById('chat-msg').value;
            if(m) {
                document.getElementById('chat').innerHTML += `<p><b>Ø£Ù†Øª:</b> ${m}</p>`;
                document.getElementById('chat-msg').value = "";
            }
        }

        function logout() { location.reload(); }
    </script>
</body>
    </html>
