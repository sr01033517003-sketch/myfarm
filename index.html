<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø²Ø±Ø¹ØªÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
    
    :root {
        --primary: #2e7d32;
        --secondary: #1b5e20;
        --accent: #ffd700;
        --brown: #5d4037;
    }

    body { 
        margin:0; font-family: 'Cairo', sans-serif; background:#3e2723; color:white; 
        text-align:center; padding-bottom: 200px; user-select: none;
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
    .quest-bar {
        background: linear-gradient(45deg, #fbc02d, #f57f17);
        color: #000; padding: 8px; font-weight: 900; font-size: 14px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3); border-bottom: 2px solid #fff;
    }

    .top-hud { 
        background: var(--secondary); padding: 15px; display: flex; 
        justify-content: space-around; align-items: center; position: sticky; top: 0; z-index: 100;
    }

    .stat-item { background: rgba(0,0,0,0.3); padding: 5px 12px; border-radius: 12px; border: 1px solid var(--accent); }

    /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ù…ØªØ·ÙˆØ± */
    .inventory-window {
        background: #fff; color: #333; margin: 10px auto; width: 90%; 
        border-radius: 15px; padding: 10px; display: flex; justify-content: space-around;
        box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
    }
    .inv-slot { display: flex; flex-direction: column; align-items: center; font-weight: bold; }
    .inv-slot span { font-size: 24px; }

    .farm-container {
        background: var(--primary); padding: 20px; border-radius: 25px;
        margin: 15px auto; width: max-content; border: 6px solid #1b5e20;
    }
    .grid { display: grid; grid-template-columns: repeat(3, 90px); gap: 12px; }
    
    .plot {
        width: 90px; height: 90px; background: #795548; border-radius: 18px;
        font-size: 38px; display: flex; align-items: center; justify-content: center;
        cursor: pointer; border: 3px solid #3e2723; transition: 0.3s;
    }
    .plot.selected { border-color: #fff; transform: scale(1.08); box-shadow: 0 0 20px #fff; }

    .controls {
        background: rgba(0,0,0,0.9); padding: 15px; position: fixed; bottom: 0;
        width: 100%; display: flex; flex-direction: column; gap: 10px; z-index: 200;
    }

    .btn {
        padding: 12px 18px; border: none; border-radius: 12px; cursor: pointer;
        font-family: Cairo; font-weight: bold; color: white; transition: 0.2s;
    }
    .btn-main { background: #43a047; box-shadow: 0 4px #2e7d32; }
    .btn-harvest { background: #fb8c00; box-shadow: 0 4px #ef6c00; }
    .btn-sell { background: #00bcd4; width: 90%; font-size: 16px; margin: 0 auto; }
    
    .level-badge {
        background: var(--accent); color: #000; padding: 2px 8px;
        border-radius: 20px; font-size: 12px; margin-right: 5px;
    }
</style>
</head>
<body>

<div class="quest-bar">
    ğŸ¯ Ø§Ù„Ù…Ù‡Ù…Ø©: <span id="quest-text">Ø§Ø­ØµØ¯ 3 Ù‚Ù…Ø­</span> (<span id="quest-progress">0</span>/3)
</div>

<div class="top-hud">
    <div class="stat-item">ğŸ’° <span id="money">0</span></div>
    <div class="stat-item"><span class="level-badge">LVL <span id="lvl">1</span></span>â­ <span id="xp">0</span></div>
</div>

<div class="inventory-window">
    <div class="inv-slot"><span>ğŸŒ¾</span> <small id="inv-wheat">0</small></div>
    <div class="inv-slot"><span>ğŸ…</span> <small id="inv-tomato">0</small></div>
    <div class="inv-slot"><span>ğŸ¥–</span> <small id="prod-bread">0</small></div>
    <div class="inv-slot"><span>ğŸ¥«</span> <small id="prod-sauce">0</small></div>
</div>

<div class="farm-container">
    <div class="grid" id="main-grid"></div>
</div>

<div class="controls">
    <div style="display: flex; gap: 8px; justify-content: center;">
        <button class="btn" style="background: #5d4037" onclick="craft('bread')">ğŸ¥– ØµÙ†Ø¹ Ø®Ø¨Ø²</button>
        <button class="btn" style="background: #5d4037" onclick="craft('sauce')">ğŸ¥« ØµÙ†Ø¹ ØµÙ„ØµØ©</button>
    </div>
    <div class="btn-row" style="display: flex; gap: 5px; justify-content: center;">
        <button class="btn btn-main" onclick="plant('wheat')">ğŸŒ¾ Ù‚Ù…Ø­</button>
        <button class="btn btn-main" style="background:#e53935" onclick="plant('tomato')">ğŸ… Ø·Ù…Ø§Ø·Ù…</button>
        <button class="btn btn-harvest" onclick="harvest()">ğŸ§º Ø­ØµØ§Ø¯</button>
        <button class="btn" style="background:#9e9e9e" onclick="buyLand()">ğŸ›’ +Ø£Ø±Ø¶</button>
    </div>
    <button onclick="sellAll()" class="btn btn-sell">ğŸ’° Ø¨ÙŠØ¹ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØµÙ†Ø¹Ø©</button>
</div>

<audio id="sound-plant" src="https://www.soundjay.com/buttons/sounds/button-37.mp3"></audio>
<audio id="sound-harvest" src="https://www.soundjay.com/buttons/sounds/button-09.mp3"></audio>

<script>
let data = JSON.parse(localStorage.getItem("farmProData")) || {
    money: 150,
    land: 6,
    plots: Array(6).fill({type: "", stage: ""}),
    inv: { wheat: 0, tomato: 0 },
    prods: { bread: 0, sauce: 0 },
    xp: 0, lvl: 1,
    quest: { target: 3, current: 0, type: 'wheat', reward: 100 }
};

let selected = null;

function save() { localStorage.setItem("farmProData", JSON.stringify(data)); }

function playSound(id) {
    const s = document.getElementById(id);
    s.currentTime = 0;
    s.play().catch(()=>{}); // Ù„ØªØ¬Ù†Ø¨ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…ØªØµÙØ­ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
}

function draw() {
    document.getElementById("money").innerText = data.money;
    document.getElementById("inv-wheat").innerText = data.inv.wheat;
    document.getElementById("inv-tomato").innerText = data.inv.tomato;
    document.getElementById("prod-bread").innerText = data.prods.bread;
    document.getElementById("prod-sauce").innerText = data.prods.sauce;
    document.getElementById("xp").innerText = data.xp;
    document.getElementById("lvl").innerText = data.lvl;
    
    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù‡Ø§Ù…
    document.getElementById("quest-text").innerText = `Ø§Ø­ØµØ¯ ${data.quest.target} ${data.quest.type === 'wheat' ? 'Ù‚Ù…Ø­' : 'Ø·Ù…Ø§Ø·Ù…'}`;
    document.getElementById("quest-progress").innerText = data.quest.current;

    const grid = document.getElementById("main-grid");
    grid.innerHTML = "";
    grid.style.gridTemplateColumns = `repeat(${data.land > 9 ? 4 : 3}, 90px)`;

    for(let i=0; i<data.land; i++) {
        let p = data.plots[i];
        let d = document.createElement("div");
        d.className = "plot" + (selected === i ? " selected" : "");
        if(p.stage === "growing") d.innerText = "ğŸŒ±";
        else if(p.stage === "ready") d.innerText = p.type === "wheat" ? "ğŸŒ¾" : "ğŸ…";
        d.onclick = () => { selected = i; draw(); };
        grid.appendChild(d);
    }
    save();
}

function plant(type) {
    if(selected === null || data.plots[selected].stage !== "") return;
    let cost = type === 'wheat' ? 5 : 15;
    if(data.money >= cost) {
        data.money -= cost;
        data.plots[selected] = { type: type, stage: "growing" };
        playSound("sound-plant");
        draw();
        let p = selected;
        setTimeout(() => {
            if(data.plots[p].stage === "growing") {
                data.plots[p].stage = "ready";
                draw();
            }
        }, type === 'wheat' ? 3000 : 7000);
    }
}

function harvest() {
    if(selected !== null && data.plots[selected].stage === "ready") {
        let type = data.plots[selected].type;
        data.inv[type]++;
        data.xp += 10;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‡Ù…Ø©
        if(data.quest.type === type) {
            data.quest.current++;
            if(data.quest.current >= data.quest.target) {
                data.money += data.quest.reward;
                alert(`âœ¨ Ø£Ø­Ø³Ù†Øª! Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù…Ù‡Ù…Ø© ÙˆØ±Ø¨Ø­Øª ${data.quest.reward}ğŸ’°`);
                data.quest.current = 0;
                data.quest.target += 2;
                data.quest.type = Math.random() > 0.5 ? 'wheat' : 'tomato';
            }
        }

        // Ù„ÙŠÙÙ„ Ø£Ø¨
        if(data.xp >= data.lvl * 100) {
            data.lvl++;
            alert("ğŸŠ Ù…Ø¨Ø±ÙˆÙƒ! ÙˆØµÙ„Øª Ù„Ù…Ø³ØªÙˆÙ‰ " + data.lvl);
        }

        data.plots[selected] = {type: "", stage: ""};
        playSound("sound-harvest");
        draw();
    }
}

function craft(prod) {
    if(prod === 'bread' && data.inv.wheat >= 3) {
        data.inv.wheat -= 3; data.prods.bread++;
    } else if(prod === 'sauce' && data.inv.tomato >= 2) {
        data.inv.tomato -= 2; data.prods.sauce++;
    } else {
        alert("Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ØºÙŠØ± ÙƒØ§ÙÙŠØ©!");
    }
    draw();
}

function sellAll() {
    let total = (data.prods.bread * 150) + (data.prods.sauce * 200);
    data.money += total;
    data.prods = { bread: 0, sauce: 0 };
    draw();
}

function buyLand() {
    if(data.money >= 50) {
        data.money -= 50; data.land++;
        data.plots.push({type: "", stage: ""});
        draw();
    }
}

draw();
</script>
</body>
    </html>
