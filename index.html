<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ±: Ø§Ù„ØªÙˆØ³Ø¹Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        
        :root {
            --primary: #2e7d32;
            --accent: #ff9800;
            --bg-ui: rgba(255, 255, 255, 0.9);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Cairo', sans-serif; user-select: none; }
        
        body { 
            background: #1b5e20; 
            height: 100vh; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column; 
        }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠØ© (HUD) */
        .hud-top {
            position: fixed; top: 10px; left: 0; right: 0;
            display: flex; justify-content: center; gap: 15px; z-index: 100;
            pointer-events: none;
        }
        .stat-card {
            background: var(--bg-ui); padding: 8px 20px; border-radius: 50px;
            border: 3px solid #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: flex; align-items: center; gap: 10px; pointer-events: auto;
            font-weight: 900; color: var(--primary);
        }

        /* Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø²Ø±Ø¹Ø© (Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙ†Ù‚Ù„) */
        #viewport {
            flex: 1; overflow: auto; cursor: grab;
            background-image: radial-gradient(#4caf50 10%, #388e3c 90%);
            display: flex; align-items: center; justify-content: center;
        }
        #world {
            display: grid; grid-template-columns: repeat(6, 150px);
            gap: 20px; padding: 500px; /* Ù…Ø³Ø§Ø­Ø© ÙˆØ§Ø³Ø¹Ø© Ù„Ù„ØªÙ†Ù‚Ù„ */
            transition: transform 0.1s;
        }

        /* Ù‚Ø·Ø¹Ø© Ø§Ù„Ø£Ø±Ø¶ */
        .plot-land {
            width: 150px; height: 150px; border-radius: 20px;
            position: relative; display: flex; align-items: center; justify-content: center;
            font-size: 50px; transition: 0.3s;
        }
        .land-unlocked { background: #5d4037; border: 5px solid #3e2723; cursor: pointer; }
        .land-locked { 
            background: rgba(0,0,0,0.4); border: 3px dashed #fff; 
            font-size: 20px; color: #fff; cursor: pointer; text-align: center;
        }
        .land-locked:hover { background: rgba(0,0,0,0.6); }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .side-menu {
            position: fixed; right: 15px; top: 100px; bottom: 100px;
            width: 280px; background: var(--bg-ui); border-radius: 25px;
            border: 4px solid var(--primary); padding: 15px; display: flex;
            flex-direction: column; gap: 15px; z-index: 200;
            box-shadow: -5px 0 20px rgba(0,0,0,0.2);
        }

        .btn-action {
            background: var(--accent); color: white; border: none;
            padding: 12px; border-radius: 15px; font-weight: bold;
            cursor: pointer; box-shadow: 0 5px #e65100; width: 100%;
        }
        .btn-action:active { transform: translateY(3px); box-shadow: 0 2px #e65100; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø®Ø¨Ø±Ø© */
        .xp-container { width: 100%; height: 12px; background: #ddd; border-radius: 6px; overflow: hidden; }
        .xp-bar { width: 30%; height: 100%; background: #2196f3; transition: 0.5s; }

        /* Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…ØµØºØ±Ø© */
        .mini-chat {
            flex: 1; background: #f1f8e9; border-radius: 15px; padding: 10px;
            font-size: 12px; overflow-y: auto; border: 1px solid #cddc39;
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¶Ø¬ */
        .ready-icon {
            position: absolute; top: -15px; animation: bounce 1s infinite;
            background: #ffeb3b; padding: 2px 8px; border-radius: 10px; font-size: 14px;
        }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="hud-top">
        <div class="stat-card">ğŸ’° <span id="gold">1000</span></div>
        <div class="stat-card">
            <div style="text-align:center">
                <span id="lvl-text">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1</span>
                <div class="xp-container"><div class="xp-bar" id="xp-bar"></div></div>
            </div>
        </div>
        <div class="stat-card">ğŸŒ± <span id="seeds">10</span></div>
    </div>

    <div id="viewport">
        <div id="world">
            </div>
    </div>

    <div class="side-menu">
        <h3 style="text-align:center; color: var(--primary)">ğŸšœ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
        
        <div class="inventory">
            <p style="font-size:14px">ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù†:</p>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px; margin-top:5px">
                <div style="background:#fff; padding:5px; border-radius:8px">ğŸŒ¾ Ù…Ø­Ø§ØµÙŠÙ„: <b id="inv-crops">0</b></div>
                <div style="background:#fff; padding:5px; border-radius:8px">ğŸ¯ Ø¹Ø³Ù„: <b id="inv-honey">0</b></div>
            </div>
        </div>

        <button class="btn-action" onclick="buySeeds()">ğŸ›’ Ø´Ø±Ø§Ø¡ Ø¨Ø°ÙˆØ± (50ğŸ’°)</button>
        <button class="btn-action" style="background:#2196f3; box-shadow: 0 5px #1976d2;" onclick="sellCrops()">ğŸ’° Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„</button>
        
        <hr>
        <div class="mini-chat" id="chat-box">
            <div><b>Ø§Ù„Ù†Ø¸Ø§Ù…:</b> Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…Ø²Ø±Ø¹Ø©! Ø§Ø³Ø­Ø¨ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„ØªÙ†Ù‚Ù„.</div>
        </div>
        <div style="display:flex; gap:5px">
            <input type="text" id="chat-input" placeholder="Ø¯Ø±Ø¯Ø´Ø©..." style="flex:1; padding:5px; border-radius:5px; border:1px solid #ccc">
            <button onclick="sendMsg()" style="padding:5px; background:var(--primary); color:white; border:none; border-radius:5px">â†©</button>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        let state = JSON.parse(localStorage.getItem('farmData')) || {
            gold: 1000, xp: 0, lvl: 1, seeds: 10, crops: 0, honey: 0,
            unlockedLands: [0, 1, 2, 3] // Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù…ÙØªÙˆØ­Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
        };

        const world = document.getElementById('world');
        const totalLands = 24; // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©

        function save() {
            localStorage.setItem('farmData', JSON.stringify(state));
            updateUI();
        }

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©
        function buildWorld() {
            world.innerHTML = '';
            for(let i=0; i < totalLands; i++) {
                let land = document.createElement('div');
                if(state.unlockedLands.includes(i)) {
                    land.className = 'plot-land land-unlocked';
                    land.onclick = () => handleLandClick(land, i);
                } else {
                    land.className = 'plot-land land-locked';
                    land.innerHTML = `ğŸ”’<br><small>${(state.unlockedLands.length * 500)}ğŸ’°</small>`;
                    land.onclick = () => unlockLand(i);
                }
                world.appendChild(land);
            }
        }

        function handleLandClick(land, id) {
            if(land.dataset.status === 'growing') return;
            
            if(land.dataset.status === 'ready') {
                harvest(land);
            } else if(state.seeds > 0) {
                plant(land);
            } else {
                addChat("Ø§Ù„Ù†Ø¸Ø§Ù…", "Ù„Ø§ ØªÙ…Ù„Ùƒ Ø¨Ø°ÙˆØ±Ø§Ù‹!");
            }
        }

        function plant(land) {
            state.seeds--;
            land.dataset.status = 'growing';
            land.innerHTML = 'ğŸŒ±';
            save();

            let growTime = 5; // 5 Ø«ÙˆØ§Ù†ÙŠ Ù„Ù„ØªØ¬Ø±Ø¨Ø©
            let timer = setInterval(() => {
                growTime--;
                if(growTime <= 0) {
                    clearInterval(timer);
                    land.dataset.status = 'ready';
                    land.innerHTML = 'ğŸŒ¾ <div class="ready-icon">Ù†Ø§Ø¶Ø¬!</div>';
                }
            }, 1000);
        }

        function harvest(land) {
            state.crops++;
            state.xp += 25;
            land.dataset.status = 'empty';
            land.innerHTML = '';
            checkLevel();
            save();
            addChat("Ø§Ù„Ù…Ø²Ø±Ø¹Ø©", "ØªÙ… Ø§Ù„Ø­ØµØ§Ø¯! +25 Ø®Ø¨Ø±Ø©");
        }

        function unlockLand(id) {
            let cost = state.unlockedLands.length * 500;
            if(state.gold >= cost) {
                state.gold -= cost;
                state.unlockedLands.push(id);
                buildWorld();
                save();
                addChat("Ø§Ù„Ù†Ø¸Ø§Ù…", "ØªÙ… ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸšœ");
            } else {
                alert("ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø°Ù‡Ø¨ Ù„Ù„ØªÙˆØ³Ø¹Ø©!");
            }
        }

        function checkLevel() {
            let nextLevelAt = state.lvl * 200;
            if(state.xp >= nextLevelAt) {
                state.lvl++;
                state.xp = 0;
                state.gold += 500;
                addChat("Ø§Ù„Ù†Ø¸Ø§Ù…", `Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ø±ØªÙØ¹Øª Ù„Ù„Ù…Ø³ØªÙˆÙ‰ ${state.lvl} ÙˆØ­ØµÙ„Øª Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ£Ø© ğŸ’°`);
            }
        }

        function buySeeds() {
            if(state.gold >= 50) {
                state.gold -= 50;
                state.seeds += 5;
                save();
            }
        }

        function sellCrops() {
            if(state.crops > 0) {
                let gain = state.crops * 80;
                state.gold += gain;
                state.crops = 0;
                save();
                addChat("Ø£Ù†Øª", `Ø¨Ø¹Øª Ø§Ù„Ù…Ø­ØµÙˆÙ„ Ù…Ù‚Ø§Ø¨Ù„ ${gain} ğŸ’°`);
            }
        }

        function updateUI() {
            document.getElementById('gold').innerText = state.gold;
            document.getElementById('seeds').innerText = state.seeds;
            document.getElementById('inv-crops').innerText = state.crops;
            document.getElementById('lvl-text').innerText = `Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${state.lvl}`;
            let nextXp = state.lvl * 200;
            document.getElementById('xp-bar').style.width = (state.xp / nextXp * 100) + "%";
        }

        function addChat(user, msg) {
            const box = document.getElementById('chat-box');
            box.innerHTML += `<div><b>${user}:</b> ${msg}</div>`;
            box.scrollTop = box.scrollHeight;
        }

        function sendMsg() {
            let inp = document.getElementById('chat-input');
            if(inp.value) { addChat("Ø£Ù†Øª", inp.value); inp.value = ''; }
        }

        // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨Ø§Ù„Ø³Ø­Ø¨ (Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆØ§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„)
        const viewport = document.getElementById('viewport');
        let isDown = false; let startX, scrollLeft, startY, scrollTop;

        viewport.addEventListener('mousedown', (e) => {
            isDown = true; viewport.style.cursor = 'grabbing';
            startX = e.pageX - viewport.offsetLeft; startY = e.pageY - viewport.offsetTop;
            scrollLeft = viewport.scrollLeft; scrollTop = viewport.scrollTop;
        });
        viewport.addEventListener('mouseleave', () => isDown = false);
        viewport.addEventListener('mouseup', () => { isDown = false; viewport.style.cursor = 'grab'; });
        viewport.addEventListener('mousemove', (e) => {
            if(!isDown) return;
            e.preventDefault();
            const x = e.pageX - viewport.offsetLeft; const y = e.pageY - viewport.offsetTop;
            const walkX = (x - startX) * 2; const walkY = (y - startY) * 2;
            viewport.scrollLeft = scrollLeft - walkX; viewport.scrollTop = scrollTop - walkY;
        });

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        buildWorld();
        updateUI();
        // ØªÙ…Ø±ÙƒØ² Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        viewport.scrollLeft = 400; viewport.scrollTop = 400;

    </script>
</body>
    </html>
