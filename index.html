<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ± - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
    body{ margin:0; font-family: 'Cairo', sans-serif; background:#3e2723; color:white; text-align:center; padding-bottom: 180px;}

    .top-hud{ background:#1b5e20; padding:15px; font-size:14px; display:flex; justify-content:space-around; align-items:center; border-bottom: 3px solid #ffd700; position: sticky; top: 0; z-index: 100;}
    .stat-item { background: rgba(0,0,0,0.3); padding: 5px 10px; border-radius: 10px; border: 1px solid #ffd700; }

    .farm-area { background:#4caf50; padding:15px; border-radius:20px; margin: 15px auto; width:max-content; border: 5px solid #2e7d32; box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
    .grid{ display:grid; grid-template-columns:repeat(3,90px); gap:10px; }
    
    .plot{ width:90px; height:90px; background:#795548; border-radius:15px; font-size:35px; display:flex; align-items:center; justify-content:center; cursor:pointer; border: 2px solid #5d4037; position: relative; transition: 0.2s;}
    .plot.selected { border: 3px solid #fff; transform: scale(1.05); box-shadow: 0 0 15px #fff; }

    .factory-panel { background: #5d4037; margin: 10px auto; padding: 15px; border-radius: 20px; width: 90%; border: 3px solid #ffd700; display: flex; flex-direction: column; gap: 10px; }
    .machine-grid { display: flex; justify-content: space-around; gap: 10px; }
    .machine { background: #3e2723; padding: 10px; border-radius: 12px; flex: 1; border: 1px solid #ffeb3b; }

    .inventory { background: #fff; color: #333; padding: 10px; margin: 10px auto; width: 90%; border-radius: 12px; font-size: 13px; font-weight: 900; display: flex; justify-content: space-around; }

    .controls { background: rgba(0,0,0,0.95); padding: 15px; position: fixed; bottom: 0; width: 100%; display: flex; flex-direction: column; align-items: center; gap: 10px; z-index: 200; border-top: 3px solid #ffd700; }
    .btn-row { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; }
    .btn { padding: 10px 15px; border: none; border-radius: 10px; cursor: pointer; font-family: Cairo; font-weight: bold; color: white; font-size: 12px; transition: 0.2s; }
    .btn:active { transform: translateY(2px); }
    
    .btn-buy { background: #00bcd4; width: 90%; font-size: 14px; }
</style>
</head>
<body>

<div class="top-hud">
    <div class="stat-item">ğŸ’° <span id="money">0</span></div>
    <div class="stat-item">ğŸ¥– Ø®Ø¨Ø²: <span id="bread-count">0</span></div>
    <div class="stat-item">ğŸ¥« ØµÙ„ØµØ©: <span id="sauce-count">0</span></div>
</div>

<div class="inventory">
    <span>ğŸŒ¾ Ø§Ù„Ù‚Ù…Ø­: <span id="wheat-inv">0</span></span>
    <span>ğŸ… Ø§Ù„Ø·Ù…Ø§Ø·Ù…: <span id="tomato-inv">0</span></span>
</div>

<div class="farm-area">
    <div class="grid" id="farm-grid"></div>
</div>

<div class="factory-panel">
    <div style="font-size: 14px; font-weight: bold;">ğŸ­ Ø®Ø·ÙˆØ· Ø§Ù„Ø¥Ù†ØªØ§Ø¬</div>
    <div class="machine-grid">
        <div class="machine">ğŸ¥– Ù…Ø®Ø¨Ø²<br><button class="btn" style="background:#f57c00; margin-top:5px;" onclick="craft('bread')">Ø§ØµÙ†Ø¹ (3 Ù‚Ù…Ø­)</button></div>
        <div class="machine">ğŸ¥« Ù…Ø¹ØµØ±Ø©<br><button class="btn" style="background:#d32f2f; margin-top:5px;" onclick="craft('sauce')">Ø§ØµÙ†Ø¹ (2 Ø·Ù…Ø§Ø·Ù…)</button></div>
    </div>
</div>

<div class="controls">
    <div class="btn-row">
        <button class="btn" style="background:#43a047" onclick="plant('wheat')">ğŸŒ¾ Ø²Ø±Ø¹ Ù‚Ù…Ø­</button>
        <button class="btn" style="background:#e53935" onclick="plant('tomato')">ğŸ… Ø²Ø±Ø¹ Ø·Ù…Ø§Ø·Ù…</button>
        <button class="btn" style="background:#fb8c00" onclick="harvest()">ğŸ§º Ø­ØµØ§Ø¯</button>
        <button class="btn" style="background:#6d4c41" onclick="buyLand()">ğŸ›’ ØªÙˆØ³ÙŠØ¹ (50)</button>
    </div>
    <button onclick="sellProducts()" class="btn btn-buy">ğŸ’° Ø¨ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØµÙ†Ø¹Ø©</button>
</div>

<script>
let data = JSON.parse(localStorage.getItem("farmFinal")) || {
    money: 100,
    land: 6,
    plots: Array(6).fill({type: "", stage: ""}),
    inv: { wheat: 0, tomato: 0 },
    prods: { bread: 0, sauce: 0 }
};

let selected = null;

function save() { localStorage.setItem("farmFinal", JSON.stringify(data)); }

function draw() {
    document.getElementById("money").innerText = Math.floor(data.money);
    document.getElementById("wheat-inv").innerText = data.inv.wheat;
    document.getElementById("tomato-inv").innerText = data.inv.tomato;
    document.getElementById("bread-count").innerText = data.prods.bread;
    document.getElementById("sauce-count").innerText = data.prods.sauce;

    const farmDiv = document.getElementById("farm-grid");
    farmDiv.innerHTML = "";
    farmDiv.style.gridTemplateColumns = `repeat(${data.land > 9 ? 4 : 3}, 90px)`;

    for(let i=0; i<data.land; i++){
        let d = document.createElement("div");
        let p = data.plots[i];
        d.className = "plot" + (selected === i ? " selected" : "");
        
        if(p.stage === "growing") d.innerText = "ğŸŒ±";
        else if(p.stage === "ready") d.innerText = p.type === "wheat" ? "ğŸŒ¾" : "ğŸ…";

        d.onclick = () => { selected = i; draw(); };
        farmDiv.appendChild(d);
    }
    save();
}

function plant(type) {
    if(selected === null || data.plots[selected].stage !== "") return;
    let cost = type === "wheat" ? 5 : 15;
    if(data.money >= cost) {
        data.money -= cost;
        data.plots[selected] = { type: type, stage: "growing" };
        draw();
        let p = selected;
        setTimeout(() => {
            if(data.plots[p].stage === "growing") {
                data.plots[p].stage = "ready";
                draw();
            }
        }, type === "wheat" ? 3000 : 7000);
    }
}

function harvest() {
    if(selected !== null && data.plots[selected].stage === "ready") {
        data.inv[data.plots[selected].type]++;
        data.plots[selected] = {type: "", stage: ""};
        draw();
    }
}

function craft(prod) {
    if(prod === 'bread' && data.inv.wheat >= 3) {
        data.inv.wheat -= 3; data.prods.bread++;
    } else if(prod === 'sauce' && data.inv.tomato >= 2) {
        data.inv.tomato -= 2; data.prods.sauce++;
    } else {
        alert("Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ØºÙŠØ± ÙƒØ§ÙÙŠØ©!");
    }
    draw();
}

function sellProducts() {
    let total = (data.prods.bread * 150) + (data.prods.sauce * 200);
    if(total > 0) {
        data.money += total;
        data.prods = { bread: 0, sauce: 0 };
        draw();
        alert(`ğŸ’° Ø¨Ø¹Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ù€ ${total} Ø°Ù‡Ø¨Ø©!`);
    }
}

function buyLand() {
    if(data.money >= 50) {
        data.money -= 50;
        data.land++;
        data.plots.push({type: "", stage: ""});
        draw();
    }
}

draw();
</script>
</body>
        </html>
